<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Payment - Digital Templates Store</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');

  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Poppins', sans-serif;
    background: #f9fafb;
    margin: 0;
    padding: 0;
    color: #1f2937;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 1rem;
  }
  .payment-container {
    background: #fff;
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    max-width: 480px;
    width: 100%;
    padding: 2rem;
    transition: box-shadow 0.3s ease;
  }
  .payment-container:hover {
    box-shadow: 0 14px 40px rgba(0,0,0,0.15);
  }
  h1 {
    font-weight: 700;
    font-size: 1.8rem;
    margin-bottom: 1rem;
    text-align: center;
    color: #ef4444;
  }
  .template-summary {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
    align-items: center;
  }
  .template-summary img {
    width: 100px;
    height: 70px;
    object-fit: cover;
    border-radius: 12px;
    box-shadow: 0 6px 20px rgba(239, 68, 68, 0.35);
  }
  .template-info {
    flex: 1;
  }
  .template-title {
    font-weight: 600;
    font-size: 1.2rem;
    margin-bottom: 0.25rem;
  }
  .template-price {
    font-weight: 700;
    color: #ef4444;
    font-size: 1.1rem;
  }
  form {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }
  label {
    font-weight: 600;
    margin-bottom: 0.25rem;
  }
  input[type="email"] {
    padding: 0.6rem 1rem;
    border-radius: 12px;
    border: 1px solid #ccc;
    font-size: 1rem;
    transition: border-color 0.3s ease;
  }
  input[type="email"]:focus {
    outline: none;
    border-color: #ef4444;
    box-shadow: 0 0 8px 2px #ef4444;
  }
  .payment-methods {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }
  .payment-methods label {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    cursor: pointer;
    padding: 0.5rem 1rem;
    border-radius: 12px;
    border: 1px solid transparent;
    transition: background-color 0.3s ease, border-color 0.3s ease;
    user-select: none;
  }
  .payment-methods input[type="radio"] {
    accent-color: #ef4444;
  }
  .payment-methods label:hover,
  .payment-methods input[type="radio"]:focus-visible + label {
    background-color: #fee2e2;
    border-color: #ef4444;
    outline: none;
  }
  .payment-details {
    background: #fef2f2;
    border: 1px solid #ef4444;
    border-radius: 12px;
    padding: 1rem;
    font-size: 0.95rem;
    color: #b91c1c;
    min-height: 3.5rem;
    transition: opacity 0.3s ease;
  }
  button {
    background-color: #ef4444;
    color: #fff;
    font-weight: 700;
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 30px;
    cursor: pointer;
    box-shadow: 0 8px 16px rgba(239, 68, 68, 0.55);
    transition: background-color 0.3s ease, box-shadow 0.3s ease;
    user-select: none;
  }
  button:hover,
  button:focus {
    background-color: #dc2626;
    box-shadow: 0 10px 20px rgba(220, 38, 38, 0.6);
    outline: none;
  }
  @media (max-width: 600px) {
    .template-summary {
      flex-direction: column;
      align-items: flex-start;
    }
    .template-summary img {
      width: 100%;
      height: auto;
    }
  }
</style>
</head>
<body>
  <div class="payment-container" role="main" aria-label="Payment page">
    <h1>Complete Your Payment</h1>
    <div class="template-summary" aria-live="polite" aria-atomic="true" aria-relevant="text">
      <img id="template-image" src="" alt="Template image" />
      <div class="template-info">
        <div id="template-title" class="template-title"></div>
        <div id="template-price" class="template-price"></div>
      </div>
    </div>
    <form id="payment-form" novalidate>
      <label for="email">Email for Payment Confirmation</label>
      <input type="email" id="email" name="email" placeholder="you@example.com" required aria-required="true" />
      <fieldset class="payment-methods" aria-label="Select payment method">
        <legend style="font-weight: 600; margin-bottom: 0.5rem;">Payment Method</legend>
        <label>
          <input type="radio" name="payment-method" value="bca" />
          BCA (Bank Transfer)
        </label>
        <label>
          <input type="radio" name="payment-method" value="bri" />
          BRI (Bank Transfer)
        </label>
        <label>
          <input type="radio" name="payment-method" value="bni" />
          BNI (Bank Transfer)
        </label>
        <label>
          <input type="radio" name="payment-method" value="mandiri" />
          Mandiri (Bank Transfer)
        </label>
        <label>
          <input type="radio" name="payment-method" value="cimb" />
          CIMB (Bank Transfer)
        </label>
        <label>
          <input type="radio" name="payment-method" value="gopay" />
          GoPay (E-wallet)
        </label>
        <label>
          <input type="radio" name="payment-method" value="ovo" />
          OVO (E-wallet)
        </label>
        <label>
          <input type="radio" name="payment-method" value="dana" />
          DANA (E-wallet)
        </label>
        <label>
          <input type="radio" name="payment-method" value="paypal" />
          PayPal (International)
        </label>
        <label>
          <input type="radio" name="payment-method" value="card" />
          Credit/Debit Card (Visa, MasterCard)
        </label>
      </fieldset>
      <div id="payment-details" class="payment-details" aria-live="polite" aria-atomic="true"></div>
      <button type="submit" id="proceed-btn" disabled>Proceed to Payment</button>
    </form>
  </div>

<script>
  (function() {
    // Simulated virtual account number generator
    function generateVirtualAccount(bankCode) {
      const randomDigits = Math.floor(1000000000 + Math.random() * 9000000000);
      return bankCode.toUpperCase() + randomDigits;
    }

    // Payment details messages for each method
    const paymentInfo = {
      bca: 'Transfer to BCA Virtual Account: ',
      bri: 'Transfer to BRI Virtual Account: ',
      bni: 'Transfer to BNI Virtual Account: ',
      mandiri: 'Transfer to Mandiri Virtual Account: ',
      cimb: 'Transfer to CIMB Virtual Account: ',
      gopay: 'Pay using GoPay app. Scan the QR code or enter your phone number.',
      ovo: 'Pay using OVO app. Scan the QR code or enter your phone number.',
      dana: 'Pay using DANA app. Scan the QR code or enter your phone number.',
      paypal: 'You will be redirected to PayPal to complete your international payment.',
      card: 'Enter your credit/debit card details on the next page.'
    };

    // Elements
    const urlParams = new URLSearchParams(window.location.search);
    const imgSrc = urlParams.get('imgSrc') || 'https://via.placeholder.com/300x200?text=Template';
    const title = urlParams.get('title') || 'Selected Template';
    const price = urlParams.get('price') || '$0';

    const templateImage = document.getElementById('template-image');
    const templateTitle = document.getElementById('template-title');
    const templatePrice = document.getElementById('template-price');
    const paymentDetails = document.getElementById('payment-details');
    const paymentForm = document.getElementById('payment-form');
    const proceedBtn = document.getElementById('proceed-btn');
    const emailInput = document.getElementById('email');

    // Initialize template summary
    templateImage.src = imgSrc;
    templateImage.alt = title;
    templateTitle.textContent = title;
    templatePrice.textContent = price;

    // State
    let selectedPaymentMethod = null;
    let virtualAccountNumber = null;

    // Validate email format
    function isValidEmail(email) {
      const re = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;
      return re.test(email);
    }

    // Update payment details display
    function updatePaymentDetails() {
      if (!selectedPaymentMethod) {
        paymentDetails.textContent = '';
        proceedBtn.disabled = true;
        return;
      }
      if (['bca','bri','bni','mandiri','cimb'].includes(selectedPaymentMethod)) {
        virtualAccountNumber = generateVirtualAccount(selectedPaymentMethod);
        paymentDetails.textContent = paymentInfo[selectedPaymentMethod] + virtualAccountNumber;
      } else {
        virtualAccountNumber = null;
        paymentDetails.textContent = paymentInfo[selectedPaymentMethod];
      }
      proceedBtn.disabled = !isValidEmail(emailInput.value.trim());
    }

    // Event listeners for payment method radios
    const paymentRadios = paymentForm.querySelectorAll('input[name="payment-method"]');
    paymentRadios.forEach(radio => {
      radio.addEventListener('change', e => {
        selectedPaymentMethod = e.target.value;
        updatePaymentDetails();
      });
    });

    // Enable/disable proceed button based on email validity and payment method selection
    emailInput.addEventListener('input', () => {
      proceedBtn.disabled = !(selectedPaymentMethod && isValidEmail(emailInput.value.trim()));
    });

    // Form submission handler
    paymentForm.addEventListener('submit', e => {
      e.preventDefault();
      const email = emailInput.value.trim();
      if (!isValidEmail(email)) {
        alert('Please enter a valid email address.');
        emailInput.focus();
        return;
      }
      if (!selectedPaymentMethod) {
        alert('Please select a payment method.');
        return;
      }
      // Placeholder for actual payment processing
      let message = `Payment initiated for "${title}" (${price}) using ${selectedPaymentMethod.toUpperCase()}.`;
      if (virtualAccountNumber) {
        message += ` Your virtual account number is ${virtualAccountNumber}.`;
      }
      message += ` A confirmation email will be sent to ${email}.`;
      alert(message);
      // Optionally reset form or redirect
      paymentForm.reset();
      paymentDetails.textContent = '';
      proceedBtn.disabled = true;
      selectedPaymentMethod = null;
      virtualAccountNumber = null;
    });
  })();
</script>
</body>
</html>
